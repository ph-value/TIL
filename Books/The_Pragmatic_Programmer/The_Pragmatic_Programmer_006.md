The Pragmatic Programmer 006
---

**TIL (Today I Learned) 날짜**
2022.03.29


**오늘 읽은 범위**
6장 동시성

**책에서 기억하고 싶은 내용을 써보세요.**
---

오늘의 이야기 : 동시성과 병렬성, 그리고 방법.

- 시간적 결합(temporal coupling)
  - 신경 쓸 것: 
    - **동시성**: 동시에 일어나는 일들
    - **순서**: 시간의 흐름 속 에서 일들의 상대적인 위치
  - 직선적 사고를 했다면, 더 유연해져야한다.
  - 동시성을 확보하면 == 시간이나 순서에 의존하는 시간적 결합을 끊는 방법을 찾는다면
    - 유연성을 얻고/ 의존성 줄이고/ 분석하기 더 쉽고/ 응답속도도 더 빠르고/ 더 안정적인 시스템을 만들 수 있을 것.
  - 동시성 찾기
    - 작업흐름 -> 모델화, 분석
    - (일어나도 되는 것 / 반드시 순서대로 일어나야 하는 것)을 찾아내기
    - 활동 다이어 그램(activity diagram)
      - 동시에 수행할 수 있는데도 아직 동시에 하고 있지 않은 활동들을 찾아내서 병렬성을 극대화.
      - 요소: 활동(모서리 둥근 상자), 화살표, 동기화 막대(synchronization bar)
      - 동기화 막대로 들어오는 활동이 모두 완료된 후에야 막대에서 나가는 화살표를 따라 진행
- 공유 상태는 틀린 상태
  - 비-원자적 갱신
  - 세마포어 및 다른 방법
    - 세마포어(semaphore): 한 번에 한 사람만이 가질 수 있는 무언가 ~~도깨비 인형~~
    - 트랜잭션
  - `Tip` 불규칙한 실패는 동시성 문제인 경우가 많다.
  - 그 밖의 독점적인 접근
    - 상호 배제(mutual exclusion)를 의미하는 뮤텍스(mutex)라고 부르기도 하고, 모니터(monitor)나 세마포어라고 부르기도 한다.
- 액터와 프로세스
  - 동시에 실행되는 작업을 구현할 때 액터를 사용하라
  - 액터: 자신만의 비공개 지역 상태state를 가진 독립적인 가상 처리 장치(virtual processor)
    - 우편함mailbox을 하나씩 보유.
    - 우편함에 메시지가 도착 -> 메시지 처리
  - 프로세스: 여기서는 마치 액터처럼 동작하도록 관례를 만들어 제한적으로만 사용할 수도 있게 제한한 것을 말함
  - 액터는 **언제나** 동시성을 띤다
    - 액터를 관리하는 것이 없다
    - 시스템이 저장하는 상태는 메시지 그리고 각 액터의 지역 상태뿐이다
    - 모든 메시지는 일방향이다. 답장X
    - 한 번에 하나의 메시지만 처리한다
  - 공유 상태 없는 동시성을 위하여 액터를 사용하라.
  - 얼랭(Erlang)과 액터 구현
    - 얼랭 런타임은 프로세스의 생애 주기를 관리하는 ‘슈퍼비전(supervision)’ 시스템을 구현
- 칠판(blackboard)
  - ex)형사들의 살인사건 조사
  - 최초의 칠판 시스템 중 하나: 데이비드 겔런터(David Gelernter)가 만든 린다(Linda)
  - 칠판+규칙엔진
    - 칠판 시스템의 법적 요구 사항을 캡슐화하는 규칙을 적용하라

오늘 읽은 소감은? 떠오르는 생각을 가볍게 적어보세요
---

시스템의 중요한 부분 중 하나인 동시성과 병렬성에 대해 다룬 이번 챕터는 레스토랑 예시와 함께 도장깨는 기분으로 가볍게 읽혔다.
이 책이 매번 말하는 중요한 의제와 함께 맞물려 더 강하게 톱니바퀴를 굴릴 수 있는 방법을 알려주는 것이다.

풀어내지 못한 어떤 구현적 처리를 동시성과 병렬성을 간과했기 때문이 아닌지 스스로에게 물어볼 수 있는 기회였다.



새로운 단어, 정보
---
- 세마포어: 에츠허르 데이크스트라가 고안한, 두 개의 원자적 함수로 조작되는 정수 변수로서, 멀티프로그래밍 환경에서 공유 자원에 대한 접근을 제한하는 방법으로 사용된다.

- 메시징 시스템:
	MSA(MicroService Architecture)에서 데이터를 송수신 하는 방법. 서비스 간 결합도를 낮추기 위해서, 비동기 요청, 성능, 안정성 등 여러가지 이점.
  - 카프카(Kafka): Apache Kafka® is an event streaming platform.
    - [Kafka](https://kafka.apache.org)는 세 가지 주요 기능을 결합하여 이벤트 스트리밍을 위한 사용 사례를 구현할 수 있습니다.
    1. 다른 시스템에서 데이터를 지속적으로 가져오거나 내보내는 것을 포함하여 이벤트 스트림을 publish(write) 및 subscribe(read)합니다.
    2. 원하는 만큼 지속 가능하고 안정적으로 이벤트 스트림을 저장.
    3. 이벤트의 스트림이 발생하거나 소급적으로 처리.
  - [NATS](https://kafka.apache.org): message oriented middleware
