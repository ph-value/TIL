
  
# 빅데이터를 지탱하는 기술

  

### 일자

2023.09.10.일

  

### CHAPTER 5 빅데이터의 파이프라인

  

### 책에서 기억하고 싶은 내용

#### 워크플로 관리 도구
- 역할: ‘정기적으로 태스크를 실행’하고 ‘비정상적인 상태를 감지하여 그것에 대한 해결을 돕는’ 것.
	- 데이터의 이동은 각각 하나의 태스크(task)로 표현된다.
- 기능
	- 태스크를 정기적인 스케줄로 실행하고 그 결과 통지하기
	- 태스크 간의 의존 관계를 정하고, 정해진 순서대로 빠짐없이 실행하기
	- 태스크의 실행 결과를 보관하고, 오류 발생 시에는 재실행할 수 있도록 하기
- **오류로부터의 복구 방법 먼저 생각하기**
	- 복구와 플로우의 재실행
	- 태스크를 되도록 작게 유지하기
	- 백필(backfill)
		- **파라미터에 포함된 일시를 순서대로 바꿔가면서** 일정 기간의 플로우를 연속 해서 실행하는 구조.
		- 태스크의 실패가 며칠 동안이나 계속된 후에 이를 모두 모아서 재실행하고 싶을 때나 새롭게 만든 워크플로를 과거로 거슬러 올라가 실행하고 싶은 경우에 사용한다.
		- 백필에 의해 대량의 태스크를 실행할 때에는 성능상의 주의 필요.
#### 멱등한 조작으로 태스크를 기술하기
- 동일 태스크를 여러 번 실행해도 동일한 결과가 되어야 한다.
- 각 태스크는 원칙적으로 ‘마지막까지 성공’하거나 ‘실패하면 아무것도 남지 않음’ 이 둘 중 하나만 존재해야 하며, ‘도중까지 성공’이라는 어정쩡한 상황은 허가하지 않는다.
- 목적 테이블을 이용해 원자성을 지닌 추가 하기
	- 복잡한 플로우에서는 하나의 테이블에 몇 번이고 데이터를 써넣을 때가 있다. 
	- 그 경우에는 추가를 반복하는 것이 아니라 중간 테이블을 만들어 처리한 후, 마지막에 목적 테이블에 한 번에 추가하는 것이 안전하다 
		- 이렇게 하면 만약 플로우의 실행 도중에 문제가 발생해도 어정쩡하게 데이터가 쓰이는 일이 없으며
		- 최악의 경우라도 중간 테이블을 삭제하여 다시 한번 처음부터 재실행할 수 있다.

#### DAG(directed acyclic graph)에 의한 내부 표현
- 성질
	- 노드와 노드가 화살표로 연결된다 (방향성)
	- 화살표를 아무리 따라가도 동일 노드로는 되돌아오지 않는다 (비순환)
	- 특징 - 지연 평가(lazy evaluation)
		- DAG 프로그램의 각 행은 실제로는 DAG의 데이터 구조를 조립하고 있을 뿐, 거기서 특별히 뭔가를 처리하지는 않는다. 
		- 먼저 DAG를 구축하고 그 후에 명시적 혹은 암묵적으로 실행 결과를 요구함에 따라 마침내 데이터 처리가 시작된다.

#### 스트리밍 형의 데이터 플로우
(TBU)

### 읽은 내용에 대한 내 생각
- `Apach Airflow`를 실습하며 익혔던 DAG 작성의 특징과 성격을 다시 상기 시킬 수 있었다.
- 다른 워크플로 관리 도구를 사용하는 경험을 가져서 응용해봐야겠다.
- 복구 가능한 워크플로를 위한 태스크 코드 작성도 숙련해야겠다.
- 스트리밍 데이터 플로우 내용 부분은 완전히 소화시키지 못했는데, 다른 예제나 참고자료를 찾아봐야겠다.
  
  

### 기타 메모